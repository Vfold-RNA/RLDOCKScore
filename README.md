# RLDOCKScore - A Scoring Function for RNA-Ligand Docking and Small Molecule Virtual Screening

## Platform Requirements (Tested)
The following are tested system settings, other hardware/software could also work but has not been tested.
* GNU/Linux x86_64 (ubuntu 22.04 LTS)
* gcc/g++ 11.4.0
* Python 3.9.21
* GNU Make 4.3

For running the */bin/openeye_get_info*
* OpenEye Toolkit 2021.2.0
* NumPy 2.0.2

For running the */bin/convert_rdock_pose* and */bin/convert_vina_pose*
* NumPy 2.0.2

## Installation

#### Compile and install RLDOCKScore

Clone the repository on your local machine
```
git clone https://github.com/Vfold-RNA/RLDOCKScore.git ${HOME}/RLDOCKScore
```
Compile the code
```
cd ${HOME}/RLDOCKScore && make
```
The executable can be found in folder **${HOME}/RLDOCKScore/bin/**.

Put the following environment variable to your *.bashrc*
```
echo "export RLDOCKSCORE_HOME=${HOME}/RLDOCKScore" >> ${HOME}/.bashrc
```
and source it
```
source ${HOME}/.bashrc
```

## Using RLDOCKScore

#### Check RLDOCKScore options
```
${RLDOCKSCORE_HOME}/bin/rldockscore -h
```

#### Run RLDOCKScore for example case
```
cd ${RLDOCKSCORE_HOME}/example && chmod +x ./run_example && ./run_example
```
The predicted scores will be saved in the corresponding folders as `*_score.dat`, 
where * will be *binding_mode* or *virtual_screen*. 

#### Run conversion scripts for example cases
```
cd ${RLDOCKSCORE_HOME}/example && chmod +x ./run_conversion_test && ./run_conversion_test
```
This script will run `convert_rdock_pose` and `convert_vina_pose` to 
convert rDock and AutoDock Vina generated poses to mol2 format compatible with `rldockscore`. 
After running the script, the predicted scores will be saved in the corresponding folders 
as `*_pose_binding_mode_score.dat` for `binding mode` score 
and `*_pose_virtual_screen_score.dat` for `virtual screen` score, 
where * will be *rdock* and *vina*. 

## RLDOCKScore command line arguments
```
-r <receptor>         # path to target RNA (in mol2 format, must contain hydrogens,
                        with AMBER ff14SB partial charges)
-l <target compound>  # path to target compound (in mol2 format, must contain hydrogens,
                        with AM1BCC or AM1BCCELF10 partial charges,
                        this conformation should be ideally minimized before being used in
                        RLDOCKScore with virtual_screen mode)
-p <compound poses>   # path to poses sampled by docking software,
                        to be scored by RLDOCKScore (in mol2 format,
                        the order of the heavy atoms should be same as the reference compound)
-i <info>             # path to the info file,
                        this file can be generated by the provided python script
                        (/bin/openeye_get_info.py),
                        but it requires a valid OpenEye Academic license (free) to run.
                        This info file should contains the following infomation,
                        user can also check the example info file in the test folder.
                        Atom index starts from 0.
                        -> lig_openeye_torsion (num of the torsions of the compound)
                        -> lig_H_donor_idx     (atom indices of the hydrogen bond donors in the compound)
                        -> lig_H_acceptor_idx  (atom indices of the hydrogen bond acceptors in the compound)
                        -> lig_aromatic_idx    (atom indices of the aromatic atoms in the compound)
                        -> nuc_H_donor_idx     (atom indices of the hydrogen bond donors in the receptor)
                        -> nuc_H_acceptor_idx  (atom indices of the hydrogen bond acceptors in the receptor)
                        -> nuc_aromatic_idx    (atom indices of the aromatic atoms in the receptor)
-s <score mode>       # should be a string, either binding_mode or virtual_screen
```

## Download data

The training set, pose prediction set, HIV-1 TAR, and robin set can be downloaded from the **Releases** or through the following commands:
```
mkdir -p ${RLDOCKSCORE_HOME}/data/
```

```
for name in "checksum.txt" "training-set.tar.gz" "pose-set.tar.gz" "jupyter.tar.gz" HIV-1-TAR.tar.gz" "robin-set"
do
  wget https://github.com/Vfold-RNA/RLDOCKScore/releases/download/data/${name} -O ${RLDOCKSCORE_HOME}/data/${name}
done
```
Check the integrity of the files:
```
cd ${RLDOCKSCORE_HOME}/data/
sha256sum --check checksum.txt
```

## References

[1] RLDOCKScore: to be published.
